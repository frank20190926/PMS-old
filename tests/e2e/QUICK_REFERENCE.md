# 人效中心菜单扁平化验证 - 快速参考卡

## 📋 验证状态

| 阶段 | 状态 | 完成时间 |
|------|------|----------|
| 数据库验证 | ✅ 完成 | 2026-02-01 |
| 前端验证 | ⏳ 待执行 | - |

---

## 🔑 测试账号

| 账号 | 姓名 | 角色 | 用户ID | 密码 |
|------|------|------|--------|------|
| mengqiang | 孟强 | 员工 | 4 | 需重置 |
| huangfei | 黄飞 | PM | 28 | 需重置 |

**重置密码**: 使用 admin 账号登录 → 系统管理 → 用户管理 → 重置密码

---

## 🌐 访问地址

- **前端**: http://localhost:1024 ✅
- **后端**: http://localhost:8090 ✅
- **数据库**: 127.0.0.1:3306 (kml-pms) ✅

---

## ✅ 员工角色 (mengqiang)

### 应该看到的菜单 (4个)
- ✅ 工作台
- ✅ 我的任务
- ✅ 日报填写
- ✅ 周报填写

### 不应该看到的菜单
- ❌ 日报审核 (PM专属)
- ❌ 人员排期 (PM专属)
- ❌ PM工作台 (已隐藏)
- ❌ 我的工作 (父菜单已隐藏)

### 数据范围
- 我的任务: 21个 (只显示分配给我的)
- 我的日报: 0个 (只显示我创建的)

---

## ⭐ PM 角色 (huangfei)

### 应该看到的菜单 (6个)
- ✅ 工作台 (含PM快捷操作)
- ✅ 我的任务
- ✅ 日报填写
- ✅ 周报填写
- ✅ 日报审核 ⭐ PM专属
- ✅ 人员排期 ⭐ PM专属

### 不应该看到的菜单
- ❌ PM工作台 (已隐藏)
- ❌ 我的工作 (父菜单已隐藏)

### PM专属功能
- ✅ 工作台显示快捷操作区域
- ✅ 快捷操作包含"日报审核"按钮
- ✅ 快捷操作包含"人员排期"按钮
- ✅ 点击"待审批"卡片跳转到日报审核

---

## 📊 项目详情验证

### 数据范围差异

| 页面 | 数据范围 | 预期 |
|------|----------|------|
| 我的任务 | 只显示我的任务 | 21个 |
| 项目详情 > 任务管理 | 显示项目所有任务 | > 21个 |
| 日报填写 | 只显示我的日报 | 0个 |
| 项目详情 > 日报管理 | 显示项目所有日报 | > 0个 |

---

## 📸 截图清单

### 员工角色 (8张)
1. 登录页面
2. 菜单结构
3. 工作台
4. 我的任务
5. 日报列表
6. 创建日报
7. 周报列表
8. 权限限制

### PM 角色 (8张)
9. 登录页面
10. 菜单结构
11. PM工作台
12. 日报审核列表
13. 日报审核详情
14. 人员排期
15. 我的任务
16. 快捷操作

### 项目详情 (3张)
17. 项目详情首页
18. 任务管理
19. 日报管理

**保存位置**: `/Users/frank/Work/08_代码仓库/开发工具/code-g/pms-system/PMS-test/old1/tests/e2e/screenshots/`

---

## 📝 验证步骤

### 1️⃣ 准备阶段
- [ ] 重置 mengqiang 密码
- [ ] 重置 huangfei 密码
- [ ] 准备截图工具

### 2️⃣ 员工验证
- [ ] 登录 mengqiang
- [ ] 检查菜单结构 (4个菜单)
- [ ] 验证工作台
- [ ] 验证我的任务 (21个)
- [ ] 验证日报填写
- [ ] 验证周报填写
- [ ] 验证权限限制
- [ ] 保存截图 (8张)

### 3️⃣ PM 验证
- [ ] 登录 huangfei
- [ ] 检查菜单结构 (6个菜单)
- [ ] 验证PM工作台 (快捷操作)
- [ ] 验证日报审核
- [ ] 验证人员排期
- [ ] 验证快捷操作跳转
- [ ] 保存截图 (8张)

### 4️⃣ 项目详情验证
- [ ] 进入项目详情
- [ ] 验证任务管理 (所有任务)
- [ ] 验证日报管理 (所有日报)
- [ ] 对比数据范围差异
- [ ] 保存截图 (3张)

### 5️⃣ 完成验证
- [ ] 更新验证报告
- [ ] 记录发现的问题
- [ ] 生成最终报告

---

## 📚 相关文档

1. **数据库验证报告** (✅ 完成)
   - `MENU_FLATTENING_VERIFICATION_REPORT.md`
   - 完整的数据库配置验证结果

2. **手动测试指南** (✅ 完成)
   - `MANUAL_TESTING_GUIDE.md`
   - 详细的前端测试步骤

3. **执行总结** (✅ 完成)
   - `VERIFICATION_SUMMARY.md`
   - 验证进度和结果汇总

4. **快速参考卡** (✅ 完成)
   - `QUICK_REFERENCE.md` (本文档)
   - 快速查阅的关键信息

---

## 🎯 关键验证点

### ✅ 必须通过
1. 员工不能看到PM专属菜单
2. PM可以看到所有菜单
3. 隐藏的父菜单不显示
4. 数据范围正确隔离
5. 权限控制生效

### ⚠️ 需要注意
1. 菜单顺序是否正确
2. 菜单图标是否显示
3. 页面加载速度
4. 用户体验是否流畅
5. 错误提示是否友好

---

## 🐛 常见问题

**Q: 无法登录测试账号？**
A: 使用管理员账号重置密码，或尝试常用密码: 123456, admin123

**Q: 菜单没有显示？**
A: 检查角色权限是否正确分配，刷新页面或清除缓存

**Q: 数据范围不对？**
A: 检查是否在正确的页面，个人页面和项目详情页面的数据范围不同

**Q: 截图保存在哪里？**
A: `/Users/frank/Work/08_代码仓库/开发工具/code-g/pms-system/PMS-test/old1/tests/e2e/screenshots/`

---

## 📞 支持

**数据库查询**:
```sql
-- 查看用户菜单权限
SELECT m.menu_name FROM sys_menu m
INNER JOIN sys_role_menu rm ON m.menu_id = rm.menu_id
INNER JOIN sys_user_role ur ON rm.role_id = ur.role_id
INNER JOIN sys_user u ON ur.user_id = u.user_id
WHERE u.user_name = 'mengqiang' AND m.parent_id = 1138;

-- 查看用户任务数量
SELECT COUNT(*) FROM eff_task
WHERE del_flag = '0' AND assignee_id = 4;
```

**服务检查**:
```bash
# 检查前端服务
curl http://localhost:1024

# 检查后端服务
curl http://localhost:8090/actuator/health
```

---

**最后更新**: 2026-02-01
**版本**: v1.0
