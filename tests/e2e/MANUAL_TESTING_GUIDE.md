# 人效中心菜单扁平化功能 - 手动测试指南

**测试日期**: 2026-02-01
**测试环境**:
- 前端: http://localhost:1024 ✅
- 后端: http://localhost:8090 ✅
- 数据库: kml-pms @ 127.0.0.1:3306 ✅

---

## 一、测试准备

### 1.1 获取测试账号密码

**方式1: 使用管理员账号重置密码 (推荐)**

1. 使用 admin 账号登录系统
   - 访问: http://localhost:1024
   - 账号: admin
   - 密码: (尝试常用密码: admin123, 123456, admin)

2. 重置测试账号密码
   - 进入"系统管理" > "用户管理"
   - 搜索用户: mengqiang
   - 点击"重置密码"按钮
   - 设置新密码: Test123456
   - 重复以上步骤重置 huangfei 的密码

**方式2: 尝试常用密码**

直接尝试以下常用密码:
- 123456
- admin123
- Test123456
- password
- 用户名相同的密码

**方式3: 查看备份SQL文件**

检查 `/Users/frank/Work/08_代码仓库/开发工具/code-g/pms-system/PMS-test/old1/kml-pms-v2-server/sql/kml-pms-20251217.sql` 中是否有密码信息。

### 1.2 测试账号信息

| 账号 | 姓名 | 角色 | 用户ID | 预期密码 |
|------|------|------|--------|----------|
| mengqiang | 孟强 | 员工 | 4 | 待重置 |
| huangfei | 黄飞 | 软研一部项目经理 | 28 | 待重置 |

### 1.3 准备截图工具

- macOS: Cmd + Shift + 4 (区域截图)
- 截图保存位置: `/Users/frank/Work/08_代码仓库/开发工具/code-g/pms-system/PMS-test/old1/tests/e2e/screenshots/`

---

## 二、员工角色测试 (mengqiang)

### 测试目标
验证员工角色只能看到基础功能菜单，不能看到PM专属菜单。

### 2.1 登录系统

1. 打开浏览器访问: http://localhost:1024
2. 输入账号: mengqiang
3. 输入密码: (重置后的密码)
4. 点击"登录"

**截图**: `01_员工_登录页面.png`

### 2.2 检查菜单结构

**预期结果**:
- ✅ 左侧菜单栏显示"人效中心"
- ✅ 展开后显示以下菜单:
  - 工作台
  - 我的任务
  - 日报填写
  - 周报填写
- ❌ 不应该显示:
  - 日报审核
  - 人员排期
  - PM工作台
  - 我的工作 (父菜单)

**测试步骤**:
1. 登录成功后，查看左侧菜单栏
2. 点击"人效中心"展开菜单
3. 记录显示的所有子菜单

**截图**: `02_员工_菜单结构.png`

**验证清单**:
- [ ] 显示"工作台"菜单
- [ ] 显示"我的任务"菜单
- [ ] 显示"日报填写"菜单
- [ ] 显示"周报填写"菜单
- [ ] 不显示"日报审核"菜单
- [ ] 不显示"人员排期"菜单
- [ ] 不显示"PM工作台"菜单
- [ ] 不显示"我的工作"父菜单

### 2.3 验证"工作台"功能

**测试步骤**:
1. 点击"人效中心" > "工作台"
2. 查看页面内容

**预期结果**:
- ✅ 显示员工工作台
- ✅ 显示个人任务统计
- ✅ 显示待办事项
- ❌ 不显示PM专属的快捷操作区域

**截图**: `03_员工_工作台.png`

**验证清单**:
- [ ] 页面正常加载
- [ ] 显示个人任务统计卡片
- [ ] 显示待办任务列表
- [ ] 不显示"日报审核"快捷按钮
- [ ] 不显示"人员排期"快捷按钮

### 2.4 验证"我的任务"功能

**测试步骤**:
1. 点击"人效中心" > "我的任务"
2. 查看任务列表

**预期结果**:
- ✅ 只显示分配给当前用户的任务
- ✅ 任务数量约为 21 个
- ✅ 所有任务的"负责人"列都是"孟强"

**截图**: `04_员工_我的任务.png`

**验证清单**:
- [ ] 页面正常加载
- [ ] 显示任务列表
- [ ] 任务数量符合预期 (约21个)
- [ ] 所有任务负责人都是当前用户
- [ ] 可以查看任务详情
- [ ] 可以更新任务状态

### 2.5 验证"日报填写"功能

**测试步骤**:
1. 点击"人效中心" > "日报填写"
2. 查看日报列表
3. 尝试创建新日报

**预期结果**:
- ✅ 只显示当前用户的日报
- ✅ 可以创建新日报
- ✅ 可以编辑未提交的日报

**截图**:
- `05_员工_日报列表.png`
- `06_员工_创建日报.png`

**验证清单**:
- [ ] 页面正常加载
- [ ] 显示日报列表
- [ ] 只显示当前用户的日报
- [ ] "新增"按钮可用
- [ ] 可以创建新日报
- [ ] 日报表单正常显示
- [ ] 可以选择任务
- [ ] 可以填写工时

### 2.6 验证"周报填写"功能

**测试步骤**:
1. 点击"人效中心" > "周报填写"
2. 查看周报列表

**预期结果**:
- ✅ 只显示当前用户的周报
- ✅ 可以创建新周报

**截图**: `07_员工_周报列表.png`

**验证清单**:
- [ ] 页面正常加载
- [ ] 显示周报列表
- [ ] 只显示当前用户的周报
- [ ] "新增"按钮可用

### 2.7 验证权限限制

**测试步骤**:
1. 尝试直接访问PM专属页面 (通过URL)
   - http://localhost:1024/#/pms/efficiency/daily-report/approve
   - http://localhost:1024/#/pms/efficiency/resource

**预期结果**:
- ❌ 显示"无权限访问"或跳转到403页面
- ❌ 或者页面加载但API返回403错误

**截图**: `08_员工_权限限制.png`

**验证清单**:
- [ ] 无法访问日报审核页面
- [ ] 无法访问人员排期页面
- [ ] 系统正确拦截未授权访问

---

## 三、PM 角色测试 (huangfei)

### 测试目标
验证PM角色可以看到所有功能菜单，包括PM专属功能。

### 3.1 登录系统

1. 退出当前账号 (mengqiang)
2. 打开浏览器访问: http://localhost:1024
3. 输入账号: huangfei
4. 输入密码: (重置后的密码)
5. 点击"登录"

**截图**: `09_PM_登录页面.png`

### 3.2 检查菜单结构

**预期结果**:
- ✅ 左侧菜单栏显示"人效中心"
- ✅ 展开后显示以下菜单:
  - 工作台
  - 我的任务
  - 日报填写
  - 周报填写
  - 日报审核 (PM专属)
  - 人员排期 (PM专属)
- ❌ 不应该显示:
  - PM工作台 (已隐藏)
  - 我的工作 (父菜单已隐藏)

**测试步骤**:
1. 登录成功后，查看左侧菜单栏
2. 点击"人效中心"展开菜单
3. 记录显示的所有子菜单

**截图**: `10_PM_菜单结构.png`

**验证清单**:
- [ ] 显示"工作台"菜单
- [ ] 显示"我的任务"菜单
- [ ] 显示"日报填写"菜单
- [ ] 显示"周报填写"菜单
- [ ] 显示"日报审核"菜单 ⭐
- [ ] 显示"人员排期"菜单 ⭐
- [ ] 不显示"PM工作台"菜单
- [ ] 不显示"我的工作"父菜单

### 3.3 验证"工作台"功能 (PM专属功能)

**测试步骤**:
1. 点击"人效中心" > "工作台"
2. 查看页面内容

**预期结果**:
- ✅ 显示PM工作台
- ✅ 显示项目统计信息
- ✅ 显示待审批卡片
- ✅ 显示PM专属的快捷操作区域
- ✅ 快捷操作包含"日报审核"和"人员排期"按钮

**截图**: `11_PM_工作台.png`

**验证清单**:
- [ ] 页面正常加载
- [ ] 显示项目统计卡片
- [ ] 显示待审批数量
- [ ] 显示快捷操作区域
- [ ] 快捷操作包含"日报审核"按钮
- [ ] 快捷操作包含"人员排期"按钮
- [ ] 点击"待审批"卡片可跳转到日报审核页面

### 3.4 验证"日报审核"功能 (PM专属)

**测试步骤**:
1. 点击"人效中心" > "日报审核"
2. 查看待审核日报列表
3. 尝试审核一条日报

**预期结果**:
- ✅ 显示待审核的日报列表
- ✅ 可以查看日报详情
- ✅ 可以审核通过或驳回

**截图**:
- `12_PM_日报审核列表.png`
- `13_PM_日报审核详情.png`

**验证清单**:
- [ ] 页面正常加载
- [ ] 显示待审核日报列表
- [ ] 可以筛选日报 (按项目、日期)
- [ ] 可以查看日报详情
- [ ] 显示"通过"按钮
- [ ] 显示"驳回"按钮
- [ ] 可以批量审核
- [ ] 审核操作成功

### 3.5 验证"人员排期"功能 (PM专属)

**测试步骤**:
1. 点击"人效中心" > "人员排期"
2. 查看人员排期页面

**预期结果**:
- ✅ 显示人员排期页面
- ✅ 可以查看团队成员的排期
- ✅ 功能正常

**截图**: `14_PM_人员排期.png`

**验证清单**:
- [ ] 页面正常加载
- [ ] 显示人员列表
- [ ] 显示排期信息
- [ ] 功能正常可用

### 3.6 验证"我的任务"功能

**测试步骤**:
1. 点击"人效中心" > "我的任务"
2. 查看任务列表

**预期结果**:
- ✅ 只显示分配给当前用户的任务
- ✅ 所有任务的"负责人"列都是"黄飞"

**截图**: `15_PM_我的任务.png`

**验证清单**:
- [ ] 页面正常加载
- [ ] 显示任务列表
- [ ] 所有任务负责人都是当前用户
- [ ] 可以查看任务详情

### 3.7 验证快捷操作功能

**测试步骤**:
1. 在PM工作台，点击快捷操作中的"日报审核"按钮
2. 验证是否跳转到日报审核页面
3. 返回工作台，点击"人员排期"按钮
4. 验证是否跳转到人员排期页面

**预期结果**:
- ✅ 快捷按钮可以正常跳转
- ✅ 跳转到正确的页面

**截图**: `16_PM_快捷操作.png`

**验证清单**:
- [ ] "日报审核"按钮可点击
- [ ] 点击后跳转到日报审核页面
- [ ] "人员排期"按钮可点击
- [ ] 点击后跳转到人员排期页面

---

## 四、项目详情功能测试

### 测试目标
验证从工作台进入项目详情后，任务和日报显示项目内所有数据，而不是只显示我的数据。

### 4.1 进入项目详情

**测试步骤**:
1. 使用 huangfei 账号登录 (PM角色)
2. 进入"人效中心" > "工作台"
3. 在项目列表中选择一个项目
4. 点击进入项目详情

**预期结果**:
- ✅ 成功进入项目详情页面
- ✅ 显示项目信息
- ✅ 显示项目内菜单

**截图**: `17_项目详情_首页.png`

**验证清单**:
- [ ] 成功进入项目详情
- [ ] 显示项目名称和基本信息
- [ ] 显示项目内菜单

### 4.2 验证项目内"任务管理"

**测试步骤**:
1. 在项目详情页面，点击"任务管理"
2. 查看任务列表
3. 对比任务数量

**预期结果**:
- ✅ 显示项目内所有任务 (不只是我的任务)
- ✅ 任务数量 > "我的任务"页面的数量
- ✅ 可以看到其他成员负责的任务

**截图**: `18_项目详情_任务管理.png`

**验证清单**:
- [ ] 页面正常加载
- [ ] 显示项目内所有任务
- [ ] 任务列表包含不同负责人的任务
- [ ] 任务数量大于"我的任务"页面
- [ ] 可以筛选和搜索任务

**数据对比**:
- "我的任务"页面任务数: _____ 个
- 项目详情任务数: _____ 个
- 差异: _____ 个 (应该 > 0)

### 4.3 验证项目内"日报管理"

**测试步骤**:
1. 在项目详情页面，点击"日报管理"
2. 查看日报列表
3. 对比日报数量

**预期结果**:
- ✅ 显示项目内所有日报 (不只是我的日报)
- ✅ 日报数量 > "日报填写"页面的数量
- ✅ 可以看到其他成员的日报

**截图**: `19_项目详情_日报管理.png`

**验证清单**:
- [ ] 页面正常加载
- [ ] 显示项目内所有日报
- [ ] 日报列表包含不同用户的日报
- [ ] 日报数量大于"日报填写"页面
- [ ] 可以筛选和搜索日报

**数据对比**:
- "日报填写"页面日报数: _____ 个
- 项目详情日报数: _____ 个
- 差异: _____ 个 (应该 > 0)

### 4.4 验证数据范围差异

**对比表格**:

| 页面 | 数据范围 | 实际数量 | 验证结果 |
|------|----------|----------|----------|
| 我的任务 | 只显示分配给我的任务 | _____ | [ ] |
| 项目详情 > 任务管理 | 显示项目内所有任务 | _____ | [ ] |
| 日报填写 | 只显示我的日报 | _____ | [ ] |
| 项目详情 > 日报管理 | 显示项目内所有日报 | _____ | [ ] |

---

## 五、测试结果汇总

### 5.1 员工角色测试结果

| 测试项 | 预期结果 | 实际结果 | 状态 | 备注 |
|--------|----------|----------|------|------|
| 菜单结构 | 显示4个基础菜单 | | [ ] | |
| 不显示PM菜单 | 不显示日报审核、人员排期 | | [ ] | |
| 工作台 | 显示员工工作台 | | [ ] | |
| 我的任务 | 只显示我的任务 | | [ ] | |
| 日报填写 | 只显示我的日报 | | [ ] | |
| 周报填写 | 只显示我的周报 | | [ ] | |
| 权限限制 | 无法访问PM页面 | | [ ] | |

### 5.2 PM 角色测试结果

| 测试项 | 预期结果 | 实际结果 | 状态 | 备注 |
|--------|----------|----------|------|------|
| 菜单结构 | 显示6个菜单 | | [ ] | |
| PM专属菜单 | 显示日报审核、人员排期 | | [ ] | |
| 隐藏父菜单 | 不显示"我的工作" | | [ ] | |
| PM工作台 | 显示快捷操作 | | [ ] | |
| 日报审核 | 可以审核日报 | | [ ] | |
| 人员排期 | 可以查看排期 | | [ ] | |
| 快捷操作 | 按钮可正常跳转 | | [ ] | |

### 5.3 项目详情测试结果

| 测试项 | 预期结果 | 实际结果 | 状态 | 备注 |
|--------|----------|----------|------|------|
| 进入项目详情 | 成功进入 | | [ ] | |
| 任务管理 | 显示所有任务 | | [ ] | |
| 日报管理 | 显示所有日报 | | [ ] | |
| 数据范围差异 | 数量大于个人页面 | | [ ] | |

### 5.4 发现的问题

| 问题编号 | 问题描述 | 严重程度 | 截图 | 状态 |
|----------|----------|----------|------|------|
| | | | | |
| | | | | |
| | | | | |

**严重程度说明**:
- 🔴 严重: 功能无法使用，阻塞测试
- 🟡 中等: 功能可用但有缺陷
- 🟢 轻微: UI问题或优化建议

---

## 六、测试总结

### 6.1 测试完成情况

- [ ] 员工角色测试完成
- [ ] PM 角色测试完成
- [ ] 项目详情测试完成
- [ ] 所有截图已保存
- [ ] 验证报告已更新

### 6.2 总体评价

**功能完整性**: _____ / 100
**用户体验**: _____ / 100
**权限控制**: _____ / 100

**总体评分**: _____ / 100

### 6.3 建议和改进

1.
2.
3.

---

## 七、附录

### 7.1 测试环境信息

```
操作系统: macOS 24.6.0
浏览器: Chrome / Safari / Firefox
前端版本: Vue 2 + Element UI
后端版本: Spring Boot (RuoYi v3.8.6)
数据库版本: MySQL 8.0
```

### 7.2 测试数据

```sql
-- 员工任务数量
SELECT COUNT(*) FROM eff_task
WHERE del_flag = '0' AND assignee_id = 4;

-- PM任务数量
SELECT COUNT(*) FROM eff_task
WHERE del_flag = '0' AND assignee_id = 28;

-- 员工日报数量
SELECT COUNT(*) FROM eff_daily_report
WHERE del_flag = '0' AND user_id = 4;

-- PM日报数量
SELECT COUNT(*) FROM eff_daily_report
WHERE del_flag = '0' AND user_id = 28;
```

### 7.3 截图清单

所有截图应保存到: `/Users/frank/Work/08_代码仓库/开发工具/code-g/pms-system/PMS-test/old1/tests/e2e/screenshots/`

**员工角色截图 (8张)**:
- [ ] 01_员工_登录页面.png
- [ ] 02_员工_菜单结构.png
- [ ] 03_员工_工作台.png
- [ ] 04_员工_我的任务.png
- [ ] 05_员工_日报列表.png
- [ ] 06_员工_创建日报.png
- [ ] 07_员工_周报列表.png
- [ ] 08_员工_权限限制.png

**PM角色截图 (8张)**:
- [ ] 09_PM_登录页面.png
- [ ] 10_PM_菜单结构.png
- [ ] 11_PM_工作台.png
- [ ] 12_PM_日报审核列表.png
- [ ] 13_PM_日报审核详情.png
- [ ] 14_PM_人员排期.png
- [ ] 15_PM_我的任务.png
- [ ] 16_PM_快捷操作.png

**项目详情截图 (3张)**:
- [ ] 17_项目详情_首页.png
- [ ] 18_项目详情_任务管理.png
- [ ] 19_项目详情_日报管理.png

---

**测试人员**: _____________
**测试日期**: 2026-02-01
**测试时长**: _____ 分钟
**签名**: _____________
